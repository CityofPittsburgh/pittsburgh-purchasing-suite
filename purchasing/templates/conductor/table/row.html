<td class="details-control"><i class="fa fa-plus"></i></td>
<td>{{ contract.id }}</td>

<td>
  <span {% if contract.stage_name -%}class="title-update-span"{%- endif -%}>{{ contract.description|title|truncate(40) }}</span>
  {% if contract.stage_name %}
  <span class="pull-right">
    <a href="{{ url_for('conductor.detail', contract_id=contract.id) }}" class="btn btn-primary btn-sm">
      Update
    </a>
  </span>
  {% endif %}
</td>

{% if type != 'in_progress' %}
<td>{{ contract.spec_number}}</td><!-- spec number -->

<td>{{ contract.expiration_date }}</td><!-- expiration date for sorting -->
<td>
  {% if contract.expiration_date %}
  <strong>{{ format_days_from_today(contract.expiration_date) }}</strong><br>
  <span class="text-muted">{{ contract.expiration_date|datetimeformat('%m/%d/%Y') }}</span>
  {% else %}
  --
  {% endif %}
</td><!-- formatted expiration date -->
{% endif %}

{% if type != 'all' %}
<td>{% if contract.stage_name %}{{ contract.stage_name }}{% else %}Not Started{% endif %}</td><!-- current stage -->

<td>{{ contract.entered }}</td><!-- current stage started for sorting -->
<td>
  {% if contract.stage_name %}
  <strong>{{ format_days_from_today(contract.entered) }}</strong><br />
  <span class="text-muted">{{ contract.entered|datetimeformat('%m/%d/%Y') }}</span>
  {% else %}
  N/A
  {% endif %}
</td><!-- formatted current stage started -->
{% endif %}

<td>
  <div class="dropdown">
    <button id="dLabel-{{ contract.id }}" class="btn btn-default btn-sm btn-assigned" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      {% if contract.assigned %}
        {{ contract.assigned }}
      {% else %}
        Not assigned
      {% endif %}
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel-{{ contract.id }}">
      {% for conductor in conductors %}
        <li><a href="{{ url_for('conductor.assign', contract_id=contract.id, user_id=conductor.id, flow_id=1) }}">{{ conductor.email }}</a></li>
      {% endfor %}
    </ul>
  </div>
</td><!-- assigned to visible -->
<td>{{ contract.assigned }}</td><!-- assigned to filter flag -->

<td>
<div class="dropdown">
  <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="actionDropdown-{{ contract.id }}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    Actions
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="actionDropdown-{{ contract.id }}">
    {% if contract.current_stage or contract.assigned %}
    <li><a href="{{ url_for('conductor.detail', contract_id=contract.id) }}">
      Update contract <span class="fa-stack" style="padding-left:5px;"><i class="fa fa-search-plus"></i></i></span>
    </a></li>
    {% endif %}
    {% if contract.contract_href %}
    <li><a href="{{ contract.contract_href }}" target="_blank">
      View Contract <span class="fa-stack" style="padding-left:5px;"><i class="fa fa-file-pdf-o"></i></span>
    </a></li>
    {% endif %}
    <li><a href="{{ url_for('wexplorer.contract', contract_id=contract.id) }}">
      View on Scout <span class="fa-stack" style="padding-left:5px;"><i class="fa fa-search"></i></span>
    </a></li>
  </ul>
</div>
</td><!-- button dropdowns -->
