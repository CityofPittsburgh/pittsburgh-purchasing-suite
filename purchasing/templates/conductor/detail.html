{% extends 'conductor/layout.html' %}

{% block content %}
{{ super() }}

<div class="container">

  <div class="row">
    <div class="col-sm-4 well event-well">
      {# Check if there is an entered and exited
          value. This means that we've already been
          through this stage entirely. Otherwise,
          check for an entered value only. This means that it's the
          current stage. If we have neither of those, gray it out
          because we aren't there yet.
       #}
      {% for stage in stages %}
        {% if stage.entered and stage.exited %}
          <div class="event event-complete">
            <p>{{ stage.name }}</p>
            <p class="event-date">
              {{ stage.exited.strftime('%Y-%m-%d') }}
            </p>
          </div>
        {% elif stage.entered %}
          <div class="event event-current">
            <p>
              {{ stage.name }}
              <a href="{{ url_for('conductor.detail', contract_id=stage.contract_id, stage_id=stage.id, transition='true') }}" id="stage-{{ stage.id }}" data-current="true" class="btn btn-sm btn-success js-transition">Mark complete!</a>
            </p>
            <p class="event-date">
              {{ stage.entered.strftime('%Y-%m-%d') }}
            </p>
          </div>
        {% else %}
          <div class="event">
            <p class="text-muted">
              {{ stage.name }}
              <a href="{{ url_for('conductor.detail', contract_id=stage.contract_id, stage_id=stage.id, transition='true') }}" id="stage-{{ stage.id }}" data-current="false" class="btn btn-sm btn-success js-transition" style="display: none;">Mark complete!</a>
            </p>
            <p class="event-date">
            </p>
          </div>
        {% endif %}
      {% endfor %}
    </div><!-- timeline view -->

    <div class="col-sm-8">
      <div class="row">
        <div class="col-md-8">
          <h4>Action Log</h4>
          <div class="action-log">
            {% if actions|length == 0 %}
              No actions!
            {% else %}
              {% for action in actions %}
                {{ action.__dict__ }}
              {% endfor %}
            {% endif %}
          </div>

        </div>
        <div class="col-md-4">
          <h4>Notes</h4>
          {% if notes|length == 0 %}
            Add a note below.
          {% else %}
            {% for note in notes %}
              {{ note.__dict__ }}
            {% endfor %}
          {% endif %}
          {{ note_form.note(class_='form-control') }}
          <button class="btn btn-primary form-control">Add Note</button>
        </div><!-- Notes -->
      </div><!-- Top Row -->
      <div class="row">
        <div class="col-sm-12">
          <h4>Send Reminder</h4>

        </div>
      </div><!-- Reminders Row -->

    </div><!-- action/content container -->
  </div><!-- row -->
</div><!-- container -->

{% endblock %}

{% block jsvars %}
<script type="text/javascript">
var contractId = {{ contract_id }};
</script>
{% endblock %}
